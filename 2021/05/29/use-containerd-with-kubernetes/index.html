<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;dark&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" href="/img/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="换到 Containerd 小半年了，没事写写。"><meta name="author" content="bleem"><meta name="keywords" content="Containerd"><title>Kubernetes 切换到 Containerd - bleem</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/atom-one-dark-reasonable.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"mritd.com",root:"/",version:"1.8.11",typing:{enable:!0,typeSpeed:80,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"❡"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:200}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:3},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:null,google:"UA-179552593-1",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="bleem" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="bleem" type="application/rss+xml">
</head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>bleem</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/friends/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(/img/default.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="Kubernetes 切换到 Containerd"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-05-29 23:01" pubdate>2021年5月29日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.8k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 46 分钟</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">Kubernetes 切换到 Containerd</h1><div class="markdown-body"><h2 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h2><ul><li>Ubuntu 20.04 x5</li><li>Etcd 3.4.16</li><li>Kubernetes 1.21.1</li><li>Containerd 1.3.3</li></ul><h3 id="1-1、处理-IPVS"><a href="#1-1、处理-IPVS" class="headerlink" title="1.1、处理 IPVS"></a>1.1、处理 IPVS</h3><p>由于 Kubernetes 新版本 Service 实现切换到 IPVS，所以需要确保内核加载了 IPVS modules；以下命令将设置系统启动自动加载 IPVS 相关模块，执行完成后需要重启。</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># Kernel modules</span>
cat &gt; /etc/modules-load.d/50-kubernetes.conf &lt;&lt;<span class="hljs-string">EOF</span>
<span class="hljs-string"># Load some kernel modules needed by kubernetes at boot</span>
<span class="hljs-string">nf_conntrack</span>
<span class="hljs-string">br_netfilter</span>
<span class="hljs-string">ip_vs</span>
<span class="hljs-string">ip_vs_lc</span>
<span class="hljs-string">ip_vs_wlc</span>
<span class="hljs-string">ip_vs_rr</span>
<span class="hljs-string">ip_vs_wrr</span>
<span class="hljs-string">ip_vs_lblc</span>
<span class="hljs-string">ip_vs_lblcr</span>
<span class="hljs-string">ip_vs_dh</span>
<span class="hljs-string">ip_vs_sh</span>
<span class="hljs-string">ip_vs_fo</span>
<span class="hljs-string">ip_vs_nq</span>
<span class="hljs-string">ip_vs_sed</span>
<span class="hljs-string">EOF</span>

<span class="hljs-comment"># sysctl</span>
cat &gt; /etc/sysctl.d/50-kubernetes.conf &lt;&lt;<span class="hljs-string">EOF</span>
<span class="hljs-string">net.ipv4.ip_forward=1</span>
<span class="hljs-string">net.bridge.bridge-nf-call-iptables=1</span>
<span class="hljs-string">net.bridge.bridge-nf-call-ip6tables=1</span>
<span class="hljs-string">fs.inotify.max_user_watches=525000</span>
<span class="hljs-string">EOF</span></code></pre></div><p>重启完成后务必检查相关 module 加载以及内核参数设置:</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># check ipvs modules</span>
➜ ~ lsmod | grep ip_vs
ip_vs_sed              16384  0
ip_vs_nq               16384  0
ip_vs_fo               16384  0
ip_vs_sh               16384  0
ip_vs_dh               16384  0
ip_vs_lblcr            16384  0
ip_vs_lblc             16384  0
ip_vs_wrr              16384  0
ip_vs_rr               16384  0
ip_vs_wlc              16384  0
ip_vs_lc               16384  0
ip_vs                 155648  22 ip_vs_wlc,ip_vs_rr,ip_vs_dh,ip_vs_lblcr,ip_vs_sh,ip_vs_fo,ip_vs_nq,ip_vs_lblc,ip_vs_wrr,ip_vs_lc,ip_vs_sed
nf_conntrack          139264  1 ip_vs
nf_defrag_ipv6         24576  2 nf_conntrack,ip_vs
libcrc32c              16384  5 nf_conntrack,btrfs,xfs,raid456,ip_vs

<span class="hljs-comment"># check sysctl</span>
➜ ~ sysctl -a | grep ip_forward
net.ipv4.ip_forward = 1
net.ipv4.ip_forward_update_priority = 1
net.ipv4.ip_forward_use_pmtu = 0

➜ ~ sysctl -a | grep bridge-nf-call
net.bridge.bridge-nf-call-arptables = 1
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1</code></pre></div><h3 id="1-2、安装-Containerd"><a href="#1-2、安装-Containerd" class="headerlink" title="1.2、安装 Containerd"></a>1.2、安装 Containerd</h3><p>Containerd 在 Ubuntu 20 中已经在默认官方仓库中包含，所以只需要 apt 安装即可:</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># 其他软件包后面可能会用到，所以顺手装了</span>
apt install containerd bridge-utils nfs-common tree -y</code></pre></div><p>安装成功后可以通过执行 <code>ctr images ls</code> 命令验证，<strong>本章节不会对 Containerd 配置做说明，Containerd 配置文件将在 Kubernetes 安装时进行配置。</strong></p><h2 id="二、安装-kubernetes"><a href="#二、安装-kubernetes" class="headerlink" title="二、安装 kubernetes"></a>二、安装 kubernetes</h2><h3 id="2-1、安装-Etcd-集群"><a href="#2-1、安装-Etcd-集群" class="headerlink" title="2.1、安装 Etcd 集群"></a>2.1、安装 Etcd 集群</h3><p>Etcd 对于 Kubernetes 来说是核心中的核心，所以个人还是比较喜欢在宿主机安装；宿主机安装情况下为了方便我打包了一些 <strong><code>*-pack</code></strong> 的工具包，用于快速处理:</p><p>安装 CFSSL 和 ETCD</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># 下载安装包</span>
wget https://github.com/mritd/etcd-pack/releases/download/v3.4.16/etcd_v3.4.16.run
wget https://github.com/mritd/cfssl-pack/releases/download/v1.5.0/cfssl_v1.5.0.run

<span class="hljs-comment"># 安装 cfssl 和 etcd</span>
chmod +x *.run
./etcd_v3.4.16.run install
./cfssl_v1.5.0.run install</code></pre></div><p>安装完成后，<strong>自行调整 <code>/etc/cfssl/etcd/etcd-csr.json</code> 相关 IP</strong>，然后执行同目录下 <code>create.sh</code> 生成证书。</p><div class="hljs code-wrapper"><pre><code class="hljs sh">➜ ~ cat /etc/cfssl/etcd/etcd-csr.json
&#123;
    <span class="hljs-string">&quot;key&quot;</span>: &#123;
        <span class="hljs-string">&quot;algo&quot;</span>: <span class="hljs-string">&quot;rsa&quot;</span>,
        <span class="hljs-string">&quot;size&quot;</span>: 2048
    &#125;,
    <span class="hljs-string">&quot;names&quot;</span>: [
        &#123;
            <span class="hljs-string">&quot;O&quot;</span>: <span class="hljs-string">&quot;etcd&quot;</span>,
            <span class="hljs-string">&quot;OU&quot;</span>: <span class="hljs-string">&quot;etcd Security&quot;</span>,
            <span class="hljs-string">&quot;L&quot;</span>: <span class="hljs-string">&quot;Beijing&quot;</span>,
            <span class="hljs-string">&quot;ST&quot;</span>: <span class="hljs-string">&quot;Beijing&quot;</span>,
            <span class="hljs-string">&quot;C&quot;</span>: <span class="hljs-string">&quot;CN&quot;</span>
        &#125;
    ],
    <span class="hljs-string">&quot;CN&quot;</span>: <span class="hljs-string">&quot;etcd&quot;</span>,
    <span class="hljs-string">&quot;hosts&quot;</span>: [
        <span class="hljs-string">&quot;127.0.0.1&quot;</span>,
        <span class="hljs-string">&quot;localhost&quot;</span>,
        <span class="hljs-string">&quot;*.etcd.node&quot;</span>,
        <span class="hljs-string">&quot;*.kubernetes.node&quot;</span>,
        <span class="hljs-string">&quot;10.0.0.11&quot;</span>,
        <span class="hljs-string">&quot;10.0.0.12&quot;</span>,
        <span class="hljs-string">&quot;10.0.0.13&quot;</span>
    ]
&#125;

<span class="hljs-comment"># 复制到 3 台 master</span>
➜ ~ <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `seq 1 3`; <span class="hljs-keyword">do</span> scp /etc/cfssl/etcd/*.pem root@10.0.0.1<span class="hljs-variable">$ip</span>:/etc/etcd/ssl; <span class="hljs-keyword">done</span></code></pre></div><p>证书生成完成后调整每台机器的 Etcd 配置文件，然后修复权限启动。</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># 复制配置</span>
<span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `seq 1 3`; <span class="hljs-keyword">do</span> scp /etc/etcd/etcd.cluster.yaml root@10.0.0.1<span class="hljs-variable">$ip</span>:/etc/etcd/etcd.yaml; <span class="hljs-keyword">done</span>

<span class="hljs-comment"># 修复权限</span>
<span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `seq 1 3`; <span class="hljs-keyword">do</span> ssh root@10.0.0.1<span class="hljs-variable">$ip</span> chown -R etcd:etcd /etc/etcd; <span class="hljs-keyword">done</span>

<span class="hljs-comment"># 每台机器启动</span>
systemctl start etcd</code></pre></div><p>启动完成后通过 <code>etcdctl</code> 验证集群状态:</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># 稳妥点应该执行 etcdctl endpoint health</span>
➜ ~ etcdctl member list
55fcbe0adaa45350, started, etcd3, https://10.0.0.13:2380, https://10.0.0.13:2379, <span class="hljs-literal">false</span>
cebdf10928a06f3c, started, etcd1, https://10.0.0.11:2380, https://10.0.0.11:2379, <span class="hljs-literal">false</span>
f7a9c20602b8532e, started, etcd2, https://10.0.0.12:2380, https://10.0.0.12:2379, <span class="hljs-literal">false</span></code></pre></div><h3 id="2-2、安装-kubeadm"><a href="#2-2、安装-kubeadm" class="headerlink" title="2.2、安装 kubeadm"></a>2.2、安装 kubeadm</h3><p>kubeadm 国内用户建议使用 aliyun 的安装源:</p><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># kubeadm</span>
apt-get install -y apt-transport-https
curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -
cat &lt;&lt;<span class="hljs-string">EOF &gt;/etc/apt/sources.list.d/kubernetes.list</span>
<span class="hljs-string">deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main</span>
<span class="hljs-string">EOF</span>
apt update

<span class="hljs-comment"># ebtables、ethtool kubelet 可能会用，具体忘了，反正从官方文档上看到的</span>
apt install kubelet kubeadm kubectl ebtables ethtool -y</code></pre></div><h3 id="2-3、安装-kube-apiserver-proxy"><a href="#2-3、安装-kube-apiserver-proxy" class="headerlink" title="2.3、安装 kube-apiserver-proxy"></a>2.3、安装 kube-apiserver-proxy</h3><p>kube-apiserver-proxy 是我自己编译的一个仅开启四层代理的 Nginx，其主要负责监听 <code>127.0.0.1:6443</code> 并负载到所有的 Api Server 地址(<code>0.0.0.0:5443</code>):</p><div class="hljs code-wrapper"><pre><code class="hljs sh">wget https://github.com/mritd/kube-apiserver-proxy-pack/releases/download/v1.20.0/kube-apiserver-proxy_v1.20.0.run
chmod +x *.run
./kube-apiserver-proxy_v1.20.0.run install</code></pre></div><p>安装完成后根据 IP 地址不同自行调整 Nginx 配置文件，然后启动:</p><div class="hljs code-wrapper"><pre><code class="hljs sh">➜ ~ cat /etc/kubernetes/apiserver-proxy.conf
error_log syslog:server=unix:/dev/<span class="hljs-built_in">log</span> notice;

worker_processes auto;
events &#123;
        multi_accept on;
        use epoll;
        worker_connections 1024;
&#125;

stream &#123;
    upstream kube_apiserver &#123;
        least_conn;
        server 10.0.0.11:5443;
        server 10.0.0.12:5443;
        server 10.0.0.13:5443;
    &#125;

    server &#123;
        listen        0.0.0.0:6443;
        proxy_pass    kube_apiserver;
        proxy_timeout 10m;
        proxy_connect_timeout 1s;
    &#125;
&#125;

systemctl start kube-apiserver-proxy</code></pre></div><h3 id="2-4、安装-kubeadm-config"><a href="#2-4、安装-kubeadm-config" class="headerlink" title="2.4、安装 kubeadm-config"></a>2.4、安装 kubeadm-config</h3><p>kubeadm-config 是一系列配置文件的组合以及 kubeadm 安装所需的必要镜像文件的打包，安装完成后将会自动配置 Containerd、ctrictl 等:</p><div class="hljs code-wrapper"><pre><code class="hljs sh">wget https://github.com/mritd/kubeadm-config-pack/releases/download/v1.21.1/kubeadm-config_v1.21.1.run
chmod +x *.run

<span class="hljs-comment"># --load 选项用于将 kubeadm 所需镜像 load 到 containerd 中</span>
./kubeadm-config_v1.21.1.run install --load</code></pre></div><h4 id="2-4-1、containerd-配置"><a href="#2-4-1、containerd-配置" class="headerlink" title="2.4.1、containerd 配置"></a>2.4.1、containerd 配置</h4><p>Containerd 配置位于 <code>/etc/containerd/config.toml</code>，其配置如下:</p><div class="hljs code-wrapper"><pre><code class="hljs toml"><span class="hljs-attr">version</span> = <span class="hljs-number">2</span>
<span class="hljs-comment"># 指定存储根目录</span>
<span class="hljs-attr">root</span> = <span class="hljs-string">&quot;/data/containerd&quot;</span>
<span class="hljs-attr">state</span> = <span class="hljs-string">&quot;/run/containerd&quot;</span>
<span class="hljs-comment"># OOM 评分</span>
<span class="hljs-attr">oom_score</span> = -<span class="hljs-number">999</span>

<span class="hljs-section">[grpc]</span>
  <span class="hljs-attr">address</span> = <span class="hljs-string">&quot;/run/containerd/containerd.sock&quot;</span>

<span class="hljs-section">[metrics]</span>
  <span class="hljs-attr">address</span> = <span class="hljs-string">&quot;127.0.0.1:1234&quot;</span>

<span class="hljs-section">[plugins]</span>
  <span class="hljs-section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;]</span>
    <span class="hljs-comment"># sandbox 镜像</span>
    <span class="hljs-attr">sandbox_image</span> = <span class="hljs-string">&quot;k8s.gcr.io/pause:3.4.1&quot;</span>
    <span class="hljs-section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd]</span>
      <span class="hljs-attr">snapshotter</span> = <span class="hljs-string">&quot;overlayfs&quot;</span>
      <span class="hljs-attr">default_runtime_name</span> = <span class="hljs-string">&quot;runc&quot;</span>
      <span class="hljs-section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes]</span>
        <span class="hljs-section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc]</span>
          <span class="hljs-attr">runtime_type</span> = <span class="hljs-string">&quot;io.containerd.runc.v2&quot;</span>
          <span class="hljs-comment"># 开启 systemd cgroup</span>
          <span class="hljs-section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options]</span>
            <span class="hljs-attr">SystemdCgroup</span> = <span class="hljs-literal">true</span></code></pre></div><h4 id="2-4-2、crictl-配置"><a href="#2-4-2、crictl-配置" class="headerlink" title="2.4.2、crictl 配置"></a>2.4.2、crictl 配置</h4><p>在切换到 Containerd 以后意味着以前的 <code>docker</code> 命令将不再可用，containerd 默认自带了一个 <code>ctr</code> 命令，同时 CRI 规范会自带一个 <code>crictl</code> 命令；<code>crictl</code> 命令配置文件存放在 <code>/etc/crictl.yaml</code> 中:</p><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">runtime-endpoint:</span> <span class="hljs-string">unix:///run/containerd/containerd.sock</span>
<span class="hljs-attr">image-endpoint:</span> <span class="hljs-string">unix:///run/containerd/containerd.sock</span>
<span class="hljs-attr">pull-image-on-create:</span> <span class="hljs-literal">true</span></code></pre></div><h4 id="2-4-3、kubeadm-配置"><a href="#2-4-3、kubeadm-配置" class="headerlink" title="2.4.3、kubeadm 配置"></a>2.4.3、kubeadm 配置</h4><p>kubeadm 配置目前分为 2 个，一个是用于首次引导启动的 init 配置，另一个是用于其他节点 join 到 master 的配置；其中比较重要的 init 配置如下:</p><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment"># /etc/kubernetes/kubeadm.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubeadm.k8s.io/v1beta2</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">InitConfiguration</span>
<span class="hljs-comment"># kubeadm token create</span>
<span class="hljs-attr">bootstrapTokens:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">token:</span> <span class="hljs-string">&quot;c2t0rj.cofbfnwwrb387890&quot;</span>
<span class="hljs-attr">nodeRegistration:</span>
  <span class="hljs-comment"># CRI 地址(Containerd)</span>
  <span class="hljs-attr">criSocket:</span> <span class="hljs-string">unix:///run/containerd/containerd.sock</span>
  <span class="hljs-attr">kubeletExtraArgs:</span>
    <span class="hljs-attr">runtime-cgroups:</span> <span class="hljs-string">&quot;/system.slice/containerd.service&quot;</span>
    <span class="hljs-attr">rotate-server-certificates:</span> <span class="hljs-string">&quot;true&quot;</span>
<span class="hljs-attr">localAPIEndpoint:</span>
  <span class="hljs-attr">advertiseAddress:</span> <span class="hljs-string">&quot;10.0.0.11&quot;</span>
  <span class="hljs-attr">bindPort:</span> <span class="hljs-number">5443</span>
<span class="hljs-comment"># kubeadm certs certificate-key</span>
<span class="hljs-attr">certificateKey:</span> <span class="hljs-string">31f1e534733a1607e5ba67b2834edd3a7debba41babb1fac1bee47072a98d88b</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubeadm.k8s.io/v1beta2</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">ClusterConfiguration</span>
<span class="hljs-attr">clusterName:</span> <span class="hljs-string">&quot;kuberentes&quot;</span>
<span class="hljs-attr">kubernetesVersion:</span> <span class="hljs-string">&quot;v1.21.1&quot;</span>
<span class="hljs-attr">certificatesDir:</span> <span class="hljs-string">&quot;/etc/kubernetes/pki&quot;</span>
<span class="hljs-comment"># Other components of the current control plane only connect to the apiserver on the current host.</span>
<span class="hljs-comment"># This is the expected behavior, see: https://github.com/kubernetes/kubeadm/issues/2271</span>
<span class="hljs-attr">controlPlaneEndpoint:</span> <span class="hljs-string">&quot;127.0.0.1:6443&quot;</span>
<span class="hljs-attr">etcd:</span>
  <span class="hljs-attr">external:</span>
    <span class="hljs-attr">endpoints:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;https://10.0.0.11:2379&quot;</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;https://10.0.0.12:2379&quot;</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;https://10.0.0.13:2379&quot;</span>
    <span class="hljs-attr">caFile:</span> <span class="hljs-string">&quot;/etc/etcd/ssl/etcd-ca.pem&quot;</span>
    <span class="hljs-attr">certFile:</span> <span class="hljs-string">&quot;/etc/etcd/ssl/etcd.pem&quot;</span>
    <span class="hljs-attr">keyFile:</span> <span class="hljs-string">&quot;/etc/etcd/ssl/etcd-key.pem&quot;</span>
<span class="hljs-attr">networking:</span>
  <span class="hljs-attr">serviceSubnet:</span> <span class="hljs-string">&quot;10.66.0.0/16&quot;</span>
  <span class="hljs-attr">podSubnet:</span> <span class="hljs-string">&quot;10.88.0.1/16&quot;</span>
  <span class="hljs-attr">dnsDomain:</span> <span class="hljs-string">&quot;cluster.local&quot;</span>
<span class="hljs-attr">apiServer:</span>
  <span class="hljs-attr">extraArgs:</span>
    <span class="hljs-attr">v:</span> <span class="hljs-string">&quot;4&quot;</span>
    <span class="hljs-attr">alsologtostderr:</span> <span class="hljs-string">&quot;true&quot;</span>
<span class="hljs-comment">#    audit-log-maxage: &quot;21&quot;</span>
<span class="hljs-comment">#    audit-log-maxbackup: &quot;10&quot;</span>
<span class="hljs-comment">#    audit-log-maxsize: &quot;100&quot;</span>
<span class="hljs-comment">#    audit-log-path: &quot;/var/log/kube-audit/audit.log&quot;</span>
<span class="hljs-comment">#    audit-policy-file: &quot;/etc/kubernetes/audit-policy.yaml&quot;</span>
    <span class="hljs-attr">authorization-mode:</span> <span class="hljs-string">&quot;Node,RBAC&quot;</span>
    <span class="hljs-attr">event-ttl:</span> <span class="hljs-string">&quot;720h&quot;</span>
    <span class="hljs-attr">runtime-config:</span> <span class="hljs-string">&quot;api/all=true&quot;</span>
    <span class="hljs-attr">service-node-port-range:</span> <span class="hljs-string">&quot;30000-50000&quot;</span>
    <span class="hljs-attr">service-cluster-ip-range:</span> <span class="hljs-string">&quot;10.66.0.0/16&quot;</span>
<span class="hljs-comment">#    insecure-bind-address: &quot;0.0.0.0&quot;</span>
<span class="hljs-comment">#    insecure-port: &quot;8080&quot;</span>
    <span class="hljs-comment"># The fraction of requests that will be closed gracefully(GOAWAY) to prevent</span>
    <span class="hljs-comment"># HTTP/2 clients from getting stuck on a single apiserver.</span>
    <span class="hljs-attr">goaway-chance:</span> <span class="hljs-string">&quot;0.001&quot;</span>
<span class="hljs-comment">#  extraVolumes:</span>
<span class="hljs-comment">#  - name: &quot;audit-config&quot;</span>
<span class="hljs-comment">#    hostPath: &quot;/etc/kubernetes/audit-policy.yaml&quot;</span>
<span class="hljs-comment">#    mountPath: &quot;/etc/kubernetes/audit-policy.yaml&quot;</span>
<span class="hljs-comment">#    readOnly: true</span>
<span class="hljs-comment">#    pathType: &quot;File&quot;</span>
<span class="hljs-comment">#  - name: &quot;audit-log&quot;</span>
<span class="hljs-comment">#    hostPath: &quot;/var/log/kube-audit&quot;</span>
<span class="hljs-comment">#    mountPath: &quot;/var/log/kube-audit&quot;</span>
<span class="hljs-comment">#    pathType: &quot;DirectoryOrCreate&quot;</span>
  <span class="hljs-attr">certSANs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;*.kubernetes.node&quot;</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;10.0.0.11&quot;</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;10.0.0.12&quot;</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;10.0.0.13&quot;</span>
  <span class="hljs-attr">timeoutForControlPlane:</span> <span class="hljs-string">1m</span>
<span class="hljs-attr">controllerManager:</span>
  <span class="hljs-attr">extraArgs:</span>
    <span class="hljs-attr">v:</span> <span class="hljs-string">&quot;4&quot;</span>
    <span class="hljs-attr">node-cidr-mask-size:</span> <span class="hljs-string">&quot;19&quot;</span>
    <span class="hljs-attr">deployment-controller-sync-period:</span> <span class="hljs-string">&quot;10s&quot;</span>
    <span class="hljs-attr">experimental-cluster-signing-duration:</span> <span class="hljs-string">&quot;8670h&quot;</span>
    <span class="hljs-attr">node-monitor-grace-period:</span> <span class="hljs-string">&quot;20s&quot;</span>
    <span class="hljs-attr">pod-eviction-timeout:</span> <span class="hljs-string">&quot;2m&quot;</span>
    <span class="hljs-attr">terminated-pod-gc-threshold:</span> <span class="hljs-string">&quot;30&quot;</span>
<span class="hljs-attr">scheduler:</span>
  <span class="hljs-attr">extraArgs:</span>
    <span class="hljs-attr">v:</span> <span class="hljs-string">&quot;4&quot;</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubelet.config.k8s.io/v1beta1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">KubeletConfiguration</span>
<span class="hljs-attr">failSwapOn:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">oomScoreAdj:</span> <span class="hljs-number">-900</span>
<span class="hljs-attr">cgroupDriver:</span> <span class="hljs-string">&quot;systemd&quot;</span>
<span class="hljs-attr">kubeletCgroups:</span> <span class="hljs-string">&quot;/system.slice/kubelet.service&quot;</span>
<span class="hljs-attr">nodeStatusUpdateFrequency:</span> <span class="hljs-string">5s</span>
<span class="hljs-attr">rotateCertificates:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">evictionSoft:</span>
  <span class="hljs-attr">&quot;imagefs.available&quot;:</span> <span class="hljs-string">&quot;15%&quot;</span>
  <span class="hljs-attr">&quot;memory.available&quot;:</span> <span class="hljs-string">&quot;512Mi&quot;</span>
  <span class="hljs-attr">&quot;nodefs.available&quot;:</span> <span class="hljs-string">&quot;15%&quot;</span>
  <span class="hljs-attr">&quot;nodefs.inodesFree&quot;:</span> <span class="hljs-string">&quot;10%&quot;</span>
<span class="hljs-attr">evictionSoftGracePeriod:</span>
  <span class="hljs-attr">&quot;imagefs.available&quot;:</span> <span class="hljs-string">&quot;3m&quot;</span>
  <span class="hljs-attr">&quot;memory.available&quot;:</span> <span class="hljs-string">&quot;1m&quot;</span>
  <span class="hljs-attr">&quot;nodefs.available&quot;:</span> <span class="hljs-string">&quot;3m&quot;</span>
  <span class="hljs-attr">&quot;nodefs.inodesFree&quot;:</span> <span class="hljs-string">&quot;1m&quot;</span>
<span class="hljs-attr">evictionHard:</span>
  <span class="hljs-attr">&quot;imagefs.available&quot;:</span> <span class="hljs-string">&quot;10%&quot;</span>
  <span class="hljs-attr">&quot;memory.available&quot;:</span> <span class="hljs-string">&quot;256Mi&quot;</span>
  <span class="hljs-attr">&quot;nodefs.available&quot;:</span> <span class="hljs-string">&quot;10%&quot;</span>
  <span class="hljs-attr">&quot;nodefs.inodesFree&quot;:</span> <span class="hljs-string">&quot;5%&quot;</span>
<span class="hljs-attr">evictionMaxPodGracePeriod:</span> <span class="hljs-number">30</span>
<span class="hljs-attr">imageGCLowThresholdPercent:</span> <span class="hljs-number">70</span>
<span class="hljs-attr">imageGCHighThresholdPercent:</span> <span class="hljs-number">80</span>
<span class="hljs-attr">kubeReserved:</span>
  <span class="hljs-attr">&quot;cpu&quot;:</span> <span class="hljs-string">&quot;500m&quot;</span>
  <span class="hljs-attr">&quot;memory&quot;:</span> <span class="hljs-string">&quot;512Mi&quot;</span>
  <span class="hljs-attr">&quot;ephemeral-storage&quot;:</span> <span class="hljs-string">&quot;1Gi&quot;</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubeproxy.config.k8s.io/v1alpha1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">KubeProxyConfiguration</span>
<span class="hljs-comment"># kube-proxy specific options here</span>
<span class="hljs-attr">clusterCIDR:</span> <span class="hljs-string">&quot;10.88.0.1/16&quot;</span>
<span class="hljs-attr">mode:</span> <span class="hljs-string">&quot;ipvs&quot;</span>
<span class="hljs-attr">oomScoreAdj:</span> <span class="hljs-number">-900</span>
<span class="hljs-attr">ipvs:</span>
  <span class="hljs-attr">minSyncPeriod:</span> <span class="hljs-string">5s</span>
  <span class="hljs-attr">syncPeriod:</span> <span class="hljs-string">5s</span>
  <span class="hljs-attr">scheduler:</span> <span class="hljs-string">&quot;wrr&quot;</span></code></pre></div><p>init 配置具体含义请自行参考官方文档，相对于 init 配置，join 配置比较简单，<strong>不过需要注意的是如果需要 join 为 master 则需要 <code>controlPlane</code> 这部分，否则请注释掉 <code>controlPlane</code>。</strong></p><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment"># /etc/kubernetes/kubeadm-join.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubeadm.k8s.io/v1beta2</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">JoinConfiguration</span>
<span class="hljs-attr">controlPlane:</span>
  <span class="hljs-attr">localAPIEndpoint:</span>
    <span class="hljs-attr">advertiseAddress:</span> <span class="hljs-string">&quot;10.0.0.12&quot;</span>
    <span class="hljs-attr">bindPort:</span> <span class="hljs-number">5443</span>
  <span class="hljs-attr">certificateKey:</span> <span class="hljs-string">31f1e534733a1607e5ba67b2834edd3a7debba41babb1fac1bee47072a98d88b</span>
<span class="hljs-attr">discovery:</span>
  <span class="hljs-attr">bootstrapToken:</span>
    <span class="hljs-attr">apiServerEndpoint:</span> <span class="hljs-string">&quot;127.0.0.1:6443&quot;</span>
    <span class="hljs-attr">token:</span> <span class="hljs-string">&quot;c2t0rj.cofbfnwwrb387890&quot;</span>
    <span class="hljs-comment"># Please replace with the &quot;--discovery-token-ca-cert-hash&quot; value printed</span>
    <span class="hljs-comment"># after the kubeadm init command is executed successfully</span>
    <span class="hljs-attr">caCertHashes:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;sha256:97590810ae34a82501717e33acfca76f16044f1a365c5ad9a1c66433c386c75c&quot;</span>
<span class="hljs-attr">nodeRegistration:</span>
  <span class="hljs-attr">criSocket:</span> <span class="hljs-string">unix:///run/containerd/containerd.sock</span>
  <span class="hljs-attr">kubeletExtraArgs:</span>
    <span class="hljs-attr">runtime-cgroups:</span> <span class="hljs-string">&quot;/system.slice/containerd.service&quot;</span>
    <span class="hljs-attr">rotate-server-certificates:</span> <span class="hljs-string">&quot;true&quot;</span></code></pre></div><h3 id="2-5、拉起-master"><a href="#2-5、拉起-master" class="headerlink" title="2.5、拉起 master"></a>2.5、拉起 master</h3><p>在调整好配置后，拉起 master 节点只需要一条命令:</p><div class="hljs code-wrapper"><pre><code class="hljs sh">kubeadm init --config /etc/kubernetes/kubeadm.yaml --upload-certs --ignore-preflight-errors=Swap</code></pre></div><p>拉起完成后记得保存相关 Token 以便于后续使用。</p><h3 id="2-6、拉起其他-master"><a href="#2-6、拉起其他-master" class="headerlink" title="2.6、拉起其他 master"></a>2.6、拉起其他 master</h3><p>在第一个 master 启动完成后，使用 <code>join</code> 命令让其他 master 加入即可；<strong>需要注意的是 <code>kubeadm-join.yaml</code> 配置中需要替换 <code>caCertHashes</code> 为第一个 master 拉起后的 <code>discovery-token-ca-cert-hash</code> 的值。</strong></p><div class="hljs code-wrapper"><pre><code class="hljs sh">kubeadm join 127.0.0.1:6443 --config /etc/kubernetes/kubeadm-join.yaml --ignore-preflight-errors=Swap</code></pre></div><h3 id="2-7、拉起其他-node"><a href="#2-7、拉起其他-node" class="headerlink" title="2.7、拉起其他 node"></a>2.7、拉起其他 node</h3><p>node 节点拉起与拉起其他 master 节点一样，唯一不同的是需要注释掉配置中的 <code>controlPlane</code> 部分。</p><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment"># /etc/kubernetes/kubeadm-join.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kubeadm.k8s.io/v1beta2</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">JoinConfiguration</span>
<span class="hljs-comment">#controlPlane:</span>
<span class="hljs-comment">#  localAPIEndpoint:</span>
<span class="hljs-comment">#    advertiseAddress: &quot;10.0.0.12&quot;</span>
<span class="hljs-comment">#    bindPort: 5443</span>
<span class="hljs-comment">#  certificateKey: 31f1e534733a1607e5ba67b2834edd3a7debba41babb1fac1bee47072a98d88b</span>
<span class="hljs-attr">discovery:</span>
  <span class="hljs-attr">bootstrapToken:</span>
    <span class="hljs-attr">apiServerEndpoint:</span> <span class="hljs-string">&quot;127.0.0.1:6443&quot;</span>
    <span class="hljs-attr">token:</span> <span class="hljs-string">&quot;c2t0rj.cofbfnwwrb387890&quot;</span>
    <span class="hljs-comment"># Please replace with the &quot;--discovery-token-ca-cert-hash&quot; value printed</span>
    <span class="hljs-comment"># after the kubeadm init command is executed successfully</span>
    <span class="hljs-attr">caCertHashes:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;sha256:97590810ae34a82501717e33acfca76f16044f1a365c5ad9a1c66433c386c75c&quot;</span>
<span class="hljs-attr">nodeRegistration:</span>
  <span class="hljs-attr">criSocket:</span> <span class="hljs-string">unix:///run/containerd/containerd.sock</span>
  <span class="hljs-attr">kubeletExtraArgs:</span>
    <span class="hljs-attr">runtime-cgroups:</span> <span class="hljs-string">&quot;/system.slice/containerd.service&quot;</span>
    <span class="hljs-attr">rotate-server-certificates:</span> <span class="hljs-string">&quot;true&quot;</span></code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs sh">kubeadm join 127.0.0.1:6443 --config /etc/kubernetes/kubeadm-join.yaml --ignore-preflight-errors=Swap</code></pre></div><h3 id="2-8、其他处理"><a href="#2-8、其他处理" class="headerlink" title="2.8、其他处理"></a>2.8、其他处理</h3><p>由于 kubelet 开启了证书轮转，所以新集群会有大量 csr 请求，批量允许即可:</p><div class="hljs code-wrapper"><pre><code class="hljs sh">kubectl get csr | grep Pending | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | xargs kubectl certificate approve</code></pre></div><p>同时为了 master 节点也能负载 pod，需要调整污点:</p><div class="hljs code-wrapper"><pre><code class="hljs sh">kubectl taint nodes --all node-role.kubernetes.io/master-</code></pre></div><p>后续 CNI 等不在本文内容范围内。</p><h2 id="三、Containerd-常用操作"><a href="#三、Containerd-常用操作" class="headerlink" title="三、Containerd 常用操作"></a>三、Containerd 常用操作</h2><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># 列出镜像</span>
ctr images ls

<span class="hljs-comment"># 列出 k8s 镜像</span>
ctr -n k8s.io images ls

<span class="hljs-comment"># 导入镜像</span>
ctr -n k8s.io images import xxxx.tar

<span class="hljs-comment"># 导出镜像</span>
ctr -n k8s.io images <span class="hljs-built_in">export</span> kube-scheduler.tar k8s.gcr.io/kube-scheduler:v1.21.1</code></pre></div><h2 id="四、资源仓库"><a href="#四、资源仓库" class="headerlink" title="四、资源仓库"></a>四、资源仓库</h2><p>本文中所有 <code>*-pack</code> 仓库地址如下:</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/mritd/cfssl-pack">https://github.com/mritd/cfssl-pack</a></li><li><a target="_blank" rel="noopener" href="https://github.com/mritd/etcd-pack">https://github.com/mritd/etcd-pack</a></li><li><a target="_blank" rel="noopener" href="https://github.com/mritd/kube-apiserver-proxy-pack">https://github.com/mritd/kube-apiserver-proxy-pack</a></li><li><a target="_blank" rel="noopener" href="https://github.com/mritd/kubeadm-config-pack">https://github.com/mritd/kubeadm-config-pack</a></li></ul></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/kubernetes/">Kubernetes</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/linux/">Linux</a> <a class="hover-with-bg" href="/tags/kubernetes/">Kubernetes</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 国际许可协议进行许可，转载请注明出处。</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2021/05/31/golang-check-certificate-expiration-time/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Golang 监控 HTTPS 证书过期时间</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2021/05/29/mysql-schema-diff/"><span class="hidden-mobile">MySQL 表结构对比</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><div class="disqus" style="width:100%"><div id="disqus_thread"></div><script type="text/javascript">var disqus_config=function(){this.page.url="https://mritd.com/2021/05/29/use-containerd-with-kubernetes/",this.page.identifier="/2021/05/29/use-containerd-with-kubernetes/"};Fluid.utils.loadComments("#disqus_thread",(function(){var e=document,t=e.createElement("script");t.src="//bleem.disqus.com/embed.js",t.setAttribute("data-timestamp",new Date),(e.head||e.body).appendChild(t)}))</script><noscript>Please enable JavaScript to view the comments</noscript></div></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:200}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="/js/local-search.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script defer>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-179552593-1","auto"),ga("send","pageview")</script><script async src="https://www.google-analytics.com/analytics.js"></script><script src="/js/boot.js"></script></body></html>